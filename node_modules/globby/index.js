import { promises as fs } from 'fs';
import path from 'path';

async function walk(dir) {
  const entries = await fs.readdir(dir, { withFileTypes: true });
  const files = [];
  for (const e of entries) {
    const p = path.join(dir, e.name);
    if (e.isDirectory()) {
      files.push(...await walk(p));
    } else {
      files.push(p);
    }
  }
  return files;
}

export default async function globby(patterns) {
  const all = await walk(process.cwd());
  const exts = ['.html', '.htm', '.md', '.markdown'];
  return all.filter(f => exts.includes(path.extname(f).toLowerCase()));
}
